<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DreamSync - Rüya Paylaşım ve Analiz</title>
    <meta name="description" content="Rüyalarınızı kaydedin, yapay zeka ile analiz edin ve toplulukla paylaşın">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#1e40af">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dream: {
                            primary: '#1e40af',      // Parliament blue
                            secondary: '#3b82f6',    // Bright blue
                            accent: '#0ea5e9',       // Sky blue
                            dark: '#1e3a8a',         // Dark parliament blue
                            light: '#dbeafe',        // Light blue
                            gradient: {
                                from: '#1e40af',
                                via: '#3b82f6', 
                                to: '#0ea5e9'
                            }
                        }
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'shimmer': 'shimmer 2s linear infinite',
                        'fadeIn': 'fadeIn 0.3s ease-in-out',
                        'slideDown': 'slideDown 0.3s ease-out',
                        'bounce-gentle': 'bounce-gentle 3s ease-in-out infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'rotate-slow': 'rotate-slow 8s linear infinite',
                        'ai-pulse': 'ai-pulse 2s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        shimmer: {
                            '0%': { backgroundPosition: '-1000px 0' },
                            '100%': { backgroundPosition: '1000px 0' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideDown: {
                            '0%': { transform: 'translateY(-10px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        'bounce-gentle': {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-5px)' },
                        },
                        glow: {
                            '0%': { boxShadow: '0 0 5px rgba(30, 64, 175, 0.4)' },
                            '100%': { boxShadow: '0 0 20px rgba(30, 64, 175, 0.8), 0 0 30px rgba(59, 130, 246, 0.4)' },
                        },
                        'rotate-slow': {
                            '0%': { transform: 'rotate(0deg)' },
                            '100%': { transform: 'rotate(360deg)' },
                        },
                        'ai-pulse': {
                            '0%, 100%': { 
                                transform: 'scale(1)',
                                filter: 'brightness(1)'
                            },
                            '50%': { 
                                transform: 'scale(1.1)',
                                filter: 'brightness(1.2)'
                            },
                        },
                    },
                    boxShadow: {
                        'dream': '0 4px 14px 0 rgba(101, 119, 247, 0.2)',
                    },
                    backgroundImage: {
                        'dream-gradient': 'linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #0ea5e9 100%)',
                        'dream-gradient-dark': 'linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #3b82f6 100%)',
                        'dream-radial': 'radial-gradient(circle at center, #3b82f6, #1e40af)',
                    },
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Quicksand', sans-serif;
        }
        
        .bg-stars {
            background-color: #0f172a;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(30, 64, 175, 0.1) 0%, transparent 50%),
                radial-gradient(white, rgba(255, 255, 255, 0.1) 1px, transparent 1px);
            background-size: 300px 300px, 400px 400px, 50px 50px;
        }
        
        .dream-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(30, 64, 175, 0.1);
            transition: all 0.3s ease;
        }
        
        .dark .dream-card {
            background: rgba(15, 23, 42, 0.85);
            border: 1px solid rgba(59, 130, 246, 0.2);
        }
        
        .dream-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(30, 64, 175, 0.15), 0 4px 12px rgba(59, 130, 246, 0.1);
        }
        
        .dark .dream-card:hover {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4), 0 4px 12px rgba(59, 130, 246, 0.2);
        }
        
        .shimmer {
            background: linear-gradient(100deg, 
                rgba(255, 255, 255, 0) 20%, 
                rgba(255, 255, 255, 0.25) 50%, 
                rgba(255, 255, 255, 0) 80%);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }
        
        .dark .shimmer {
            background: linear-gradient(100deg, 
                rgba(45, 55, 72, 0) 20%, 
                rgba(45, 55, 72, 0.25) 50%, 
                rgba(45, 55, 72, 0) 80%);
            background-size: 200% 100%;
        }
        
        .floating {
            animation: float 6s ease-in-out infinite;
        }
        
        .bg-blur {
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        
        .dark ::-webkit-scrollbar-thumb {
            background: #475569;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: #3b82f6;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 0 8px rgba(30, 64, 175, 0.3);
        }
        
        .dark input[type="range"]::-webkit-slider-thumb {
            border-color: #1e3a8a;
        }
        
        /* Recording animation */
        @keyframes recording-pulse {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
        
        .recording-pulse {
            animation: recording-pulse 2s infinite;
        }
        
        /* Credit count badge animation */
        @keyframes pulse-ring {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(30, 64, 175, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 5px rgba(30, 64, 175, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(30, 64, 175, 0); }
        }
        
        .credit-pulse {
            animation: pulse-ring 2s infinite;
        }
        
        /* AI Robot Icon Styles */
        .ai-robot-icon {
            position: relative;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: ai-pulse 2s ease-in-out infinite, glow 3s ease-in-out infinite alternate;
        }
        
        .ai-robot-icon::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #3b82f6, #0ea5e9, #1e40af, #3b82f6);
            border-radius: 14px;
            z-index: -1;
            animation: rotate-slow 8s linear infinite;
        }
        
        .ai-robot-icon .robot-face {
            position: relative;
            width: 32px;
            height: 32px;
            color: white;
            font-size: 24px;
        }
        
        .ai-robot-icon .robot-eyes {
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 6px;
        }
        
        .ai-robot-icon .robot-eye {
            width: 4px;
            height: 4px;
            background: #60a5fa;
            border-radius: 50%;
            animation: ai-blink 3s ease-in-out infinite;
        }
        
        .ai-robot-icon .robot-mouth {
            position: absolute;
            bottom: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 12px;
            height: 2px;
            background: #60a5fa;
            border-radius: 1px;
            animation: ai-talk 2s ease-in-out infinite;
        }
        
        @keyframes ai-blink {
            0%, 90%, 100% { opacity: 1; transform: scaleY(1); }
            95% { opacity: 0.3; transform: scaleY(0.1); }
        }
        
        @keyframes ai-talk {
            0%, 50%, 100% { width: 12px; }
            25%, 75% { width: 8px; }
        }
        
        /* Loading state */
        .loading {
            pointer-events: none;
            opacity: 0.7;
        }
        
        .error-state {
            border-color: #ef4444;
            background-color: #fef2f2;
        }
        
        .dark .error-state {
            background-color: #1e1b1b;
        }
        
        /* Accessibility improvements */
        .focus-visible:focus-visible {
            outline: 2px solid #3b82f6;
            outline-offset: 2px;
        }
        
        /* Skip to content link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: #1e40af;
            color: white;
            padding: 8px;
            text-decoration: none;
            border-radius: 4px;
            z-index: 1000;
        }
        
        .skip-link:focus {
            top: 6px;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen transition-colors duration-200">
    <!-- Skip to content link for accessibility -->
    <a href="#main-content" class="skip-link">Ana içeriğe geç</a>
    
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center">
        <div class="bg-white dark:bg-gray-800 rounded-lg p-6 flex items-center">
            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-dream-primary mr-3"></div>
            <span>Yükleniyor...</span>
        </div>
    </div>

    <!-- Error Toast -->
    <div id="error-toast" class="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 hidden animate-slideDown">
        <div class="flex items-center">
            <i class="fas fa-exclamation-circle mr-2"></i>
            <span id="error-message">Bir hata oluştu</span>
            <button onclick="hideErrorToast()" class="ml-3 text-white hover:text-gray-200">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <!-- Success Toast -->
    <div id="success-toast" class="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 hidden animate-slideDown">
        <div class="flex items-center">
            <i class="fas fa-check-circle mr-2"></i>
            <span id="success-message">İşlem başarılı</span>
            <button onclick="hideSuccessToast()" class="ml-3 text-white hover:text-gray-200">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>

    <!-- Container -->
    <div class="mx-auto max-w-6xl px-4 py-5">
        <!-- Header Component -->
        <header class="flex justify-between items-center mb-8" role="banner">
            <div class="flex items-center">
                <!-- Back Button -->
                <button id="back-button" 
                        class="mr-2 p-2 bg-white dark:bg-gray-800 rounded-lg shadow-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible hidden"
                        aria-label="Geri dön">
                    <i class="fas fa-arrow-left" aria-hidden="true"></i>
                </button>
                
                <!-- Logo -->
                <div class="flex items-center">
                    <div class="ai-robot-icon mr-3">
                        <div class="robot-face">
                            <i class="fas fa-robot" aria-hidden="true"></i>
                            <div class="robot-eyes">
                                <div class="robot-eye"></div>
                                <div class="robot-eye"></div>
                            </div>
                            <div class="robot-mouth"></div>
                        </div>
                    </div>
                    <h1 class="text-3xl font-bold bg-clip-text text-transparent bg-dream-gradient dark:bg-dream-gradient-dark">
                        Dream<span class="font-light">Sync</span>
                    </h1>
                </div>
            </div>
            
            <!-- User Profile / Login Area -->
            <div id="login-area" class="flex items-center">
                <button id="login-button" 
                        class="ml-2 px-4 py-2 bg-dream-primary text-white rounded-lg transition-colors hover:bg-dream-primary/90 focus-visible"
                        aria-label="Giriş yap">
                    <i class="fas fa-sign-in-alt mr-2" aria-hidden="true"></i> Giriş Yap
                </button>
                <button id="register-button" 
                        class="ml-2 px-4 py-2 bg-white dark:bg-gray-800 text-dream-primary dark:text-dream-secondary border border-dream-primary dark:border-dream-secondary rounded-lg transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 focus-visible"
                        aria-label="Kayıt ol">
                    <i class="fas fa-user-plus mr-2" aria-hidden="true"></i> Kayıt Ol
                </button>
            </div>
            
            <!-- Logged In User Area -->
            <div id="user-area" class="hidden items-center">
                <div id="credit-counter" class="relative mr-4">
                    <div class="flex items-center px-3 py-1.5 bg-dream-primary/10 dark:bg-dream-primary/20 text-dream-primary dark:text-dream-secondary rounded-full"
                         aria-label="Kredi durumu">
                        <i class="fas fa-star mr-2" aria-hidden="true"></i>
                        <span id="credit-count">3</span> <span class="ml-1 text-xs">kredi</span>
                    </div>
                </div>
                <div class="relative group">
                    <button id="user-menu-button" 
                            class="flex items-center focus-visible"
                            aria-haspopup="true"
                            aria-expanded="false"
                            aria-label="Kullanıcı menüsü">
                        <div class="w-10 h-10 rounded-full bg-dream-gradient flex items-center justify-center text-white mr-2">
                            <span id="user-initial">K</span>
                        </div>
                        <span id="username-display" class="hidden md:inline-block">KullanıcıAdı</span>
                        <i class="fas fa-chevron-down ml-2 text-xs opacity-70" aria-hidden="true"></i>
                    </button>
                    
                    <div id="user-dropdown" 
                         class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden z-50 hidden animate-slideDown"
                         role="menu"
                         aria-labelledby="user-menu-button">
                        <div class="p-3 border-b border-gray-200 dark:border-gray-700">
                            <p id="dropdown-username" class="font-medium">KullanıcıAdı</p>
                            <p id="dropdown-email" class="text-xs text-gray-500 dark:text-gray-400">kullanici@mail.com</p>
                        </div>
                        <div>
                            <button id="account-btn" 
                                    class="w-full text-left flex items-center px-4 py-2.5 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible"
                                    role="menuitem">
                                <i class="fas fa-user text-gray-500 dark:text-gray-400 w-5" aria-hidden="true"></i>
                                <span class="ml-2">Hesabım</span>
                            </button>
                            <button id="credits-btn" 
                                    class="w-full text-left flex items-center px-4 py-2.5 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible"
                                    role="menuitem">
                                <i class="fas fa-star text-gray-500 dark:text-gray-400 w-5" aria-hidden="true"></i>
                                <span class="ml-2">Kredi Satın Al</span>
                            </button>
                            <button id="settings-btn" 
                                    class="w-full text-left flex items-center px-4 py-2.5 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible"
                                    role="menuitem">
                                <i class="fas fa-cog text-gray-500 dark:text-gray-400 w-5" aria-hidden="true"></i>
                                <span class="ml-2">Ayarlar</span>
                            </button>
                            <button id="theme-btn" 
                                    class="w-full text-left flex items-center px-4 py-2.5 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible"
                                    role="menuitem"
                                    aria-label="Tema değiştir">
                                <i class="fas fa-moon text-gray-500 dark:text-gray-400 w-5 dark:hidden" aria-hidden="true"></i>
                                <i class="fas fa-sun text-gray-500 dark:text-gray-400 w-5 hidden dark:block" aria-hidden="true"></i>
                                <span class="ml-2">Tema Değiştir</span>
                            </button>
                            <hr class="border-gray-200 dark:border-gray-700">
                            <button id="logout-btn" 
                                    class="w-full text-left flex items-center px-4 py-2.5 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible"
                                    role="menuitem">
                                <i class="fas fa-sign-out-alt text-gray-500 dark:text-gray-400 w-5" aria-hidden="true"></i>
                                <span class="ml-2">Çıkış Yap</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Mobile Nav Toggle -->
            <button id="mobile-nav-toggle" 
                    class="md:hidden bg-white dark:bg-gray-800 p-2 rounded-lg shadow-md ml-2 focus-visible"
                    aria-label="Mobil menüyü aç"
                    aria-expanded="false">
                <i class="fas fa-bars text-dream-primary" aria-hidden="true"></i>
            </button>
        </header>
        
        <!-- Mobile Navigation Component -->
        <nav id="mobile-nav" 
             class="hidden md:hidden bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 mb-6 transition-all animate-slideDown"
             role="navigation"
             aria-label="Mobil navigasyon">
            <div class="flex flex-col space-y-2">
                <!-- Mobile User Section -->
                <div id="mobile-user-section" class="hidden">
                    <div class="flex items-center p-3 mb-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div class="w-10 h-10 rounded-full bg-dream-gradient flex items-center justify-center text-white mr-3">
                            <span id="mobile-user-initial">K</span>
                        </div>
                        <div>
                            <p id="mobile-username" class="font-medium">KullanıcıAdı</p>
                            <div class="flex items-center text-xs text-dream-primary dark:text-dream-secondary">
                                <i class="fas fa-star mr-1" aria-hidden="true"></i>
                                <span id="mobile-credit-count">3</span> kredi
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Mobile Login/Register -->
                <div id="mobile-auth-section" class="grid grid-cols-2 gap-2 mb-3">
                    <button id="mobile-login-button" 
                            class="px-4 py-2.5 bg-dream-primary text-white rounded-lg transition-colors hover:bg-dream-primary/90 focus-visible">
                        <i class="fas fa-sign-in-alt mr-2" aria-hidden="true"></i> Giriş Yap
                    </button>
                    <button id="mobile-register-button" 
                            class="px-4 py-2.5 bg-white dark:bg-gray-700 text-dream-primary dark:text-dream-secondary border border-dream-primary dark:border-dream-secondary rounded-lg transition-colors hover:bg-gray-50 dark:hover:bg-gray-600 focus-visible">
                        <i class="fas fa-user-plus mr-2" aria-hidden="true"></i> Kayıt Ol
                    </button>
                </div>
                
                <button id="mobile-nav-journal" 
                        class="mobile-nav-btn flex items-center px-4 py-3 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible">
                    <i class="fas fa-book mr-3 text-dream-primary" aria-hidden="true"></i> Rüya Günlüğüm
                </button>
                <button id="mobile-nav-community" 
                        class="mobile-nav-btn flex items-center px-4 py-3 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible">
                    <i class="fas fa-users mr-3 text-dream-primary" aria-hidden="true"></i> Topluluk
                </button>
                <button id="mobile-nav-training" 
                        class="mobile-nav-btn flex items-center px-4 py-3 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible">
                    <i class="fas fa-brain mr-3 text-dream-primary" aria-hidden="true"></i> Lucid Dreaming Eğitimi
                </button>
                
                <!-- Mobile User Options -->
                <div id="mobile-user-options" class="hidden pt-2 mt-2 border-t border-gray-200 dark:border-gray-700">
                    <button id="mobile-account-btn" 
                            class="w-full text-left flex items-center px-4 py-3 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible">
                        <i class="fas fa-user mr-3 text-gray-500" aria-hidden="true"></i> Hesabım
                    </button>
                    <button id="mobile-credits-btn" 
                            class="w-full text-left flex items-center px-4 py-3 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible">
                        <i class="fas fa-star mr-3 text-gray-500" aria-hidden="true"></i> Kredi Satın Al
                    </button>
                    <button id="mobile-logout-btn" 
                            class="w-full text-left flex items-center px-4 py-3 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible">
                        <i class="fas fa-sign-out-alt mr-3 text-gray-500" aria-hidden="true"></i> Çıkış Yap
                    </button>
                </div>
                
                <hr class="border-gray-200 dark:border-gray-700">
                <div class="flex justify-between items-center px-4 py-3">
                    <span class="text-gray-700 dark:text-gray-300">Karanlık Mod</span>
                    <button id="mobile-theme-toggle" 
                            class="p-2 rounded-full bg-gray-100 dark:bg-gray-700 focus-visible"
                            aria-label="Tema değiştir">
                        <i class="fas fa-moon dark:hidden text-dream-primary" aria-hidden="true"></i>
                        <i class="fas fa-sun hidden dark:block text-yellow-400" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </nav>

        <!-- Desktop Navigation Component -->
        <nav id="desktop-nav" 
             class="hidden md:flex mb-8 bg-white dark:bg-gray-800 rounded-xl shadow-sm py-2 px-1"
             role="navigation"
             aria-label="Ana navigasyon">
            <button id="nav-journal" 
                    class="nav-btn flex-1 px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible">
                <i class="fas fa-book mr-2" aria-hidden="true"></i> Günlüğüm
            </button>
            <button id="nav-community" 
                    class="nav-btn flex-1 px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible">
                <i class="fas fa-users mr-2" aria-hidden="true"></i> Topluluk
            </button>
            <button id="nav-training" 
                    class="nav-btn flex-1 px-4 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors focus-visible">
                <i class="fas fa-brain mr-2" aria-hidden="true"></i> Eğitim
            </button>
        </nav>

        <!-- Main Content Area -->
        <main id="main-content" role="main">
            <!-- Welcome Screen Component -->
            <section id="welcome-screen" class="block">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                    <div class="order-2 md:order-1">
                        <h2 class="text-3xl font-bold mb-4">Rüyalarınızı Keşfedin ve Paylaşın</h2>
                        <p class="text-gray-600 dark:text-gray-400 mb-6">
                            DreamSync, rüyalarınızı kaydetmenize, yapay zeka ile analiz etmenize ve benzer rüyalar gören kişilerle paylaşmanıza olanak tanır.
                        </p>
                        <div class="space-y-4">
                            <div class="flex items-start">
                                <div class="bg-dream-primary text-white p-2 rounded-lg mr-3" aria-hidden="true">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div>
                                    <h3 class="font-semibold">Rüya Günlüğü</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Rüyalarınızı kaydedin ve zaman içinde izleyin</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="bg-dream-secondary text-white p-2 rounded-lg mr-3" aria-hidden="true">
                                    <i class="fas fa-robot"></i>
                                </div>
                                <div>
                                    <h3 class="font-semibold">Yapay Zeka Analizi</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Rüyanızın gizli anlamlarını keşfedin</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="bg-dream-accent text-white p-2 rounded-lg mr-3" aria-hidden="true">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div>
                                    <h3 class="font-semibold">Topluluk Paylaşımı</h3>
                                    <p class="text-sm text-gray-600 dark:text-gray-400">Benzer rüyalar gören kişilerle bağlantı kurun</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="order-1 md:order-2 text-center">
                        <div class="relative">
                            <img src="https://i.imgur.com/PZUhNlv.png" 
                                 alt="Rüya illüstrasyonu - bulutların üzerinde yıldızlı gökyüzü" 
                                 class="w-full max-w-md mx-auto floating rounded-lg shadow-dream"
                                 loading="lazy">
                            <div class="absolute inset-0 bg-dream-gradient opacity-10 rounded-lg"></div>
                        </div>
                    </div>
                </div>

                <!-- Stats Section -->
                <div class="mt-12 grid grid-cols-1 md:grid-cols-4 gap-6">
                    <div class="dream-card rounded-xl p-6 text-center">
                        <div class="w-12 h-12 bg-dream-primary rounded-full flex items-center justify-center mx-auto mb-3">
                            <i class="fas fa-book text-white" aria-hidden="true"></i>
                        </div>
                        <h3 class="font-semibold mb-1">Rüya Kaydı</h3>
                        <p class="text-2xl font-bold text-dream-primary" aria-label="Son 7 günde 12 rüya">12</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400">Son 7 günde</p>
                    </div>
                    
                    <div class="dream-card rounded-xl p-6 text-center">
                        <div class="w-12 h-12 bg-dream-secondary rounded-full flex items-center justify-center mx-auto mb-3">
                            <i class="fas fa-eye text-white" aria-hidden="true"></i>
                        </div>
                        <h3 class="font-semibold mb-1">Lucid Rüya</h3>
                        <p class="text-2xl font-bold text-dream-secondary" aria-label="Başarı oranı yüzde 68">68%</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400">Başarı oranı</p>
                    </div>
                    
                    <div class="dream-card rounded-xl p-6 text-center">
                        <div class="w-12 h-12 bg-dream-accent rounded-full flex items-center justify-center mx-auto mb-3">
                            <i class="fas fa-hashtag text-white" aria-hidden="true"></i>
                        </div>
                        <h3 class="font-semibold mb-1">En Sık Tema</h3>
                        <p class="text-2xl font-bold text-dream-accent">Uçma</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400">Rüyalarınızda</p>
                    </div>
                    
                    <div class="dream-card rounded-xl p-6 text-center">
                        <div class="w-12 h-12 bg-emerald-500 rounded-full flex items-center justify-center mx-auto mb-3">
                            <i class="fas fa-users text-white" aria-hidden="true"></i>
                        </div>
                        <h3 class="font-semibold mb-1">Topluluk</h3>
                        <p class="text-2xl font-bold text-emerald-500" aria-label="1247 aktif kullanıcı">1.2K</p>
                        <p class="text-xs text-gray-500 dark:text-gray-400">Aktif kullanıcı</p>
                    </div>
                </div>

                <!-- Community Dreams Preview -->
                <div class="mt-12">
                    <h3 class="text-2xl font-bold mb-6 text-center">Topluluk Rüyaları</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <article class="dream-card rounded-xl p-6">
                            <div class="flex items-start justify-between mb-3">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 rounded-full bg-dream-secondary flex items-center justify-center text-white mr-3">
                                        <span>A</span>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold">Uçma Deneyimi</h4>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Anonim Kullanıcı</p>
                                    </div>
                                </div>
                                <span class="px-2 py-1 bg-blue-100 dark:bg-blue-900/50 text-dream-primary dark:text-blue-200 text-xs rounded-full">
                                    Lucid
                                </span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400 line-clamp-4">
                                "Rüyamda şehrin üzerinde özgürce uçabiliyordum. Binaların arasından geçerken kanatlarım yoktu ama düşüncelerimle hareket edebiliyordum..."
                            </p>
                            <div class="flex items-center justify-between mt-4">
                                <div class="flex items-center text-xs text-gray-500 dark:text-gray-400">
                                    <i class="fas fa-heart mr-1 text-red-400" aria-hidden="true"></i>
                                    <span>24 beğeni</span>
                                </div>
                                <button class="text-dream-primary hover:text-dream-primary/80 text-xs font-medium focus-visible">
                                    Devamını Oku
                                </button>
                            </div>
                        </article>
                        
                        <article class="dream-card rounded-xl p-6">
                            <div class="flex items-start justify-between mb-3">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 rounded-full bg-purple-500 flex items-center justify-center text-white mr-3">
                                        <span>B</span>
                                    </div>
                                    <div>
                                        <h4 class="font-semibold">Labirent Yolculuğu</h4>
                                        <p class="text-xs text-gray-500 dark:text-gray-400">Anonim Kullanıcı</p>
                                    </div>
                                </div>
                                <span class="px-2 py-1 bg-purple-100 dark:bg-purple-900/50 text-purple-800 dark:text-purple-200 text-xs rounded-full">
                                    Sembolik
                                </span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400 line-clamp-4">
                                "Sonsuz gibi görünen bir labirentte yolumu bulmaya çalışıyordum. Duvarlar sürekli değişiyor ve döndükçe yeni koridorlar açılıyordu..."
                            </p>
                            <div class="flex items-center justify-between mt-4">
                                <div class="flex items-center text-xs text-gray-500 dark:text-gray-400">
                                    <i class="fas fa-heart mr-1 text-red-400" aria-hidden="true"></i>
                                    <span>18 beğeni</span>
                                </div>
                                <button class="text-dream-primary hover:text-dream-primary/80 text-xs font-medium focus-visible">
                                    Devamını Oku
                                </button>
                            </div>
                        </article>
                    </div>
                </div>

                <!-- CTA Section -->
                <div class="mt-12 text-center">
                    <div class="dream-card rounded-xl p-8 bg-dream-gradient text-white relative overflow-hidden">
                        <div class="absolute inset-0 bg-dream-radial opacity-20"></div>
                        <div class="relative z-10">
                            <div class="flex items-center justify-center mb-4">
                                <div class="ai-robot-icon mr-4 scale-75">
                                    <div class="robot-face">
                                        <i class="fas fa-robot" aria-hidden="true"></i>
                                        <div class="robot-eyes">
                                            <div class="robot-eye"></div>
                                            <div class="robot-eye"></div>
                                        </div>
                                        <div class="robot-mouth"></div>
                                    </div>
                                </div>
                                <h3 class="text-2xl font-bold">DreamSync Premium</h3>
                            </div>
                            <p class="mb-6 opacity-90">Yapay zeka ile sınırsız rüya analizi için kredi satın alın</p>
                            <button class="bg-white text-dream-primary px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors focus-visible hover:shadow-lg">
                                <i class="fas fa-star mr-2"></i>
                                Hemen Başla
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Login Modal Component -->
            <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center animate-fadeIn">
                <div class="bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md mx-4 animate-slideDown" role="dialog" aria-labelledby="login-title" aria-modal="true">
                    <div class="flex justify-between items-center mb-6">
                        <h2 id="login-title" class="text-xl font-bold">DreamSync'e Hoş Geldiniz</h2>
                        <button id="close-login-modal" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 focus-visible" aria-label="Modalı kapat">
                            <i class="fas fa-times" aria-hidden="true"></i>
                        </button>
                    </div>
                    <p class="text-gray-600 dark:text-gray-400 mb-6">Rüya yolculuğunuza devam etmek için giriş yapın</p>
                    
                    <form id="login-form" novalidate>
                        <div class="space-y-4">
                            <div>
                                <label for="login-email" class="block text-sm font-medium mb-2">E-posta</label>
                                <input type="email" 
                                       id="login-email" 
                                       name="email"
                                       class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-dream-primary dark:bg-gray-700 focus-visible"
                                       placeholder="ornek@email.com"
                                       required
                                       aria-describedby="email-error">
                                <div id="email-error" class="text-red-500 text-xs mt-1 hidden"></div>
                            </div>
                            <div>
                                <label for="login-password" class="block text-sm font-medium mb-2">Şifre</label>
                                <input type="password" 
                                       id="login-password" 
                                       name="password"
                                       class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-dream-primary dark:bg-gray-700 focus-visible"
                                       placeholder="••••••••"
                                       required
                                       aria-describedby="password-error">
                                <div id="password-error" class="text-red-500 text-xs mt-1 hidden"></div>
                            </div>
                        </div>
                        
                        <button type="submit" 
                                id="login-submit"
                                class="w-full mt-6 bg-dream-primary text-white py-2 rounded-lg hover:bg-dream-primary/90 transition-colors focus-visible">
                            <span class="login-text">Giriş Yap</span>
                            <span class="login-loading hidden">
                                <i class="fas fa-spinner fa-spin mr-2" aria-hidden="true"></i>
                                Giriş yapılıyor...
                            </span>
                        </button>
                    </form>
                    
                    <div class="mt-4 text-center">
                        <p class="text-sm text-gray-600 dark:text-gray-400">
                            Hesabınız yok mu? 
                            <button id="switch-to-register" class="text-dream-primary hover:underline focus-visible">Kayıt olun</button>
                        </p>
                    </div>
                </div>
            </div>

            <!-- Register Modal Component -->
            <div id="register-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center animate-fadeIn">
                <div class="bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md mx-4 animate-slideDown" role="dialog" aria-labelledby="register-title" aria-modal="true">
                    <div class="flex justify-between items-center mb-6">
                        <h2 id="register-title" class="text-xl font-bold">DreamSync'e Katılın</h2>
                        <button id="close-register-modal" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 focus-visible" aria-label="Modalı kapat">
                            <i class="fas fa-times" aria-hidden="true"></i>
                        </button>
                    </div>
                    <p class="text-gray-600 dark:text-gray-400 mb-6">Rüya deneyimlerinizi keşfedin ve paylaşın</p>
                    
                    <form id="register-form" novalidate>
                        <div class="space-y-4">
                            <div>
                                <label for="register-name" class="block text-sm font-medium mb-2">Ad Soyad</label>
                                <input type="text" 
                                       id="register-name" 
                                       name="name"
                                       class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-dream-primary dark:bg-gray-700 focus-visible"
                                       placeholder="Ad Soyad"
                                       required
                                       aria-describedby="name-error">
                                <div id="name-error" class="text-red-500 text-xs mt-1 hidden"></div>
                            </div>
                            <div>
                                <label for="register-email" class="block text-sm font-medium mb-2">E-posta</label>
                                <input type="email" 
                                       id="register-email" 
                                       name="email"
                                       class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-dream-primary dark:bg-gray-700 focus-visible"
                                       placeholder="ornek@email.com"
                                       required
                                       aria-describedby="register-email-error">
                                <div id="register-email-error" class="text-red-500 text-xs mt-1 hidden"></div>
                            </div>
                            <div>
                                <label for="register-password" class="block text-sm font-medium mb-2">Şifre</label>
                                <input type="password" 
                                       id="register-password" 
                                       name="password"
                                       class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-dream-primary dark:bg-gray-700 focus-visible"
                                       placeholder="••••••••"
                                       required
                                       minlength="8"
                                       aria-describedby="register-password-error register-password-help">
                                <div id="register-password-help" class="text-xs text-gray-500 dark:text-gray-400 mt-1">En az 8 karakter olmalıdır</div>
                                <div id="register-password-error" class="text-red-500 text-xs mt-1 hidden"></div>
                            </div>
                        </div>
                        
                        <button type="submit" 
                                id="register-submit"
                                class="w-full mt-6 bg-dream-primary text-white py-2 rounded-lg hover:bg-dream-primary/90 transition-colors focus-visible">
                            <span class="register-text">Kayıt Ol</span>
                            <span class="register-loading hidden">
                                <i class="fas fa-spinner fa-spin mr-2" aria-hidden="true"></i>
                                Kayıt olunuyor...
                            </span>
                        </button>
                    </form>
                    
                    <div class="mt-4 text-center">
                        <p class="text-sm text-gray-600 dark:text-gray-400">
                            Zaten hesabınız var mı? 
                            <button id="switch-to-login" class="text-dream-primary hover:underline focus-visible">Giriş yapın</button>
                        </p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Global State Management
        const AppState = {
            user: null,
            credits: 3,
            theme: localStorage.getItem('theme') || 'auto',
            isLoading: false,
            currentScreen: 'welcome'
        };

        // Theme Management
        class ThemeManager {
            constructor() {
                this.init();
            }

            init() {
                this.applyTheme(AppState.theme);
                this.bindEvents();
            }

            applyTheme(theme) {
                const html = document.documentElement;
                
                if (theme === 'dark') {
                    html.classList.add('dark');
                } else if (theme === 'light') {
                    html.classList.remove('dark');
                } else {
                    // Auto mode
                    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                    html.classList.toggle('dark', prefersDark);
                }
                
                AppState.theme = theme;
                localStorage.setItem('theme', theme);
            }

            bindEvents() {
                // Theme toggle buttons
                document.getElementById('theme-btn')?.addEventListener('click', () => this.toggleTheme());
                document.getElementById('mobile-theme-toggle')?.addEventListener('click', () => this.toggleTheme());

                // System theme change detection
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                    if (AppState.theme === 'auto') {
                        document.documentElement.classList.toggle('dark', e.matches);
                    }
                });
            }

            toggleTheme() {
                const currentTheme = AppState.theme;
                let newTheme;

                if (currentTheme === 'light') {
                    newTheme = 'dark';
                } else if (currentTheme === 'dark') {
                    newTheme = 'auto';
                } else {
                    newTheme = 'light';
                }

                this.applyTheme(newTheme);
            }
        }

        // Navigation Manager
        class NavigationManager {
            constructor() {
                this.currentScreen = 'welcome';
                this.bindEvents();
            }

            bindEvents() {
                // Mobile navigation toggle
                document.getElementById('mobile-nav-toggle')?.addEventListener('click', this.toggleMobileNav);
                
                // Navigation buttons
                document.getElementById('nav-journal')?.addEventListener('click', () => this.navigateTo('journal'));
                document.getElementById('nav-community')?.addEventListener('click', () => this.navigateTo('community'));
                document.getElementById('nav-training')?.addEventListener('click', () => this.navigateTo('training'));
                
                // Mobile navigation buttons
                document.getElementById('mobile-nav-journal')?.addEventListener('click', () => this.navigateTo('journal'));
                document.getElementById('mobile-nav-community')?.addEventListener('click', () => this.navigateTo('community'));
                document.getElementById('mobile-nav-training')?.addEventListener('click', () => this.navigateTo('training'));
                
                // Back button
                document.getElementById('back-button')?.addEventListener('click', () => this.navigateTo('welcome'));
            }

            toggleMobileNav() {
                const mobileNav = document.getElementById('mobile-nav');
                const toggle = document.getElementById('mobile-nav-toggle');
                const isHidden = mobileNav.classList.contains('hidden');
                
                mobileNav.classList.toggle('hidden', !isHidden);
                toggle.setAttribute('aria-expanded', isHidden.toString());
            }

            navigateTo(screen) {
                this.currentScreen = screen;
                AppState.currentScreen = screen;
                
                // Hide all screens
                document.querySelectorAll('[id$="-screen"]').forEach(el => {
                    el.classList.add('hidden');
                });
                
                // Show target screen
                const targetScreen = document.getElementById(`${screen}-screen`);
                if (targetScreen) {
                    targetScreen.classList.remove('hidden');
                }
                
                // Update navigation state
                this.updateNavigationState(screen);
                
                // Close mobile navigation
                document.getElementById('mobile-nav').classList.add('hidden');
                document.getElementById('mobile-nav-toggle').setAttribute('aria-expanded', 'false');
            }

            updateNavigationState(screen) {
                const backButton = document.getElementById('back-button');
                const desktopNav = document.getElementById('desktop-nav');
                
                if (screen === 'welcome') {
                    backButton.classList.add('hidden');
                    desktopNav.classList.add('hidden');
                } else {
                    backButton.classList.remove('hidden');
                    desktopNav.classList.remove('hidden');
                }
                
                // Update active navigation state
                document.querySelectorAll('.nav-btn, .mobile-nav-btn').forEach(btn => {
                    btn.classList.remove('bg-dream-primary', 'text-white');
                    btn.classList.add('text-gray-700', 'dark:text-gray-300');
                });
                
                const activeBtn = document.getElementById(`nav-${screen}`) || document.getElementById(`mobile-nav-${screen}`);
                if (activeBtn) {
                    activeBtn.classList.add('bg-dream-primary', 'text-white');
                    activeBtn.classList.remove('text-gray-700', 'dark:text-gray-300');
                }
            }
        }

        // Auth Manager
        class AuthManager {
            constructor() {
                this.bindEvents();
            }

            bindEvents() {
                // Login/Register button events
                document.getElementById('login-button')?.addEventListener('click', () => this.showLoginModal());
                document.getElementById('register-button')?.addEventListener('click', () => this.showRegisterModal());
                document.getElementById('mobile-login-button')?.addEventListener('click', () => this.showLoginModal());
                document.getElementById('mobile-register-button')?.addEventListener('click', () => this.showRegisterModal());
                
                // Modal close events
                document.getElementById('close-login-modal')?.addEventListener('click', () => this.hideLoginModal());
                document.getElementById('close-register-modal')?.addEventListener('click', () => this.hideRegisterModal());
                
                // Modal switch events
                document.getElementById('switch-to-register')?.addEventListener('click', () => {
                    this.hideLoginModal();
                    this.showRegisterModal();
                });
                document.getElementById('switch-to-login')?.addEventListener('click', () => {
                    this.hideRegisterModal();
                    this.showLoginModal();
                });
                
                // Form submit events
                document.getElementById('login-form')?.addEventListener('submit', (e) => this.handleLogin(e));
                document.getElementById('register-form')?.addEventListener('submit', (e) => this.handleRegister(e));
                
                // User menu events
                document.getElementById('user-menu-button')?.addEventListener('click', this.toggleUserDropdown);
                document.getElementById('logout-btn')?.addEventListener('click', () => this.logout());
                document.getElementById('mobile-logout-btn')?.addEventListener('click', () => this.logout());
                
                // Click outside to close dropdowns
                document.addEventListener('click', (e) => {
                    if (!e.target.closest('#user-dropdown') && !e.target.closest('#user-menu-button')) {
                        this.hideUserDropdown();
                    }
                    if (!e.target.closest('#login-modal .bg-white')) {
                        this.hideLoginModal();
                    }
                    if (!e.target.closest('#register-modal .bg-white')) {
                        this.hideRegisterModal();
                    }
                });
            }

            showLoginModal() {
                document.getElementById('login-modal').classList.remove('hidden');
                document.getElementById('login-modal').classList.add('flex');
                document.getElementById('login-email').focus();
            }

            hideLoginModal() {
                document.getElementById('login-modal').classList.add('hidden');
                document.getElementById('login-modal').classList.remove('flex');
                this.clearForm('login-form');
            }

            showRegisterModal() {
                document.getElementById('register-modal').classList.remove('hidden');
                document.getElementById('register-modal').classList.add('flex');
                document.getElementById('register-name').focus();
            }

            hideRegisterModal() {
                document.getElementById('register-modal').classList.add('hidden');
                document.getElementById('register-modal').classList.remove('flex');
                this.clearForm('register-form');
            }

            toggleUserDropdown() {
                const dropdown = document.getElementById('user-dropdown');
                const button = document.getElementById('user-menu-button');
                const isHidden = dropdown.classList.contains('hidden');
                
                dropdown.classList.toggle('hidden', !isHidden);
                button.setAttribute('aria-expanded', isHidden.toString());
            }

            hideUserDropdown() {
                document.getElementById('user-dropdown').classList.add('hidden');
                document.getElementById('user-menu-button').setAttribute('aria-expanded', 'false');
            }

            async handleLogin(e) {
                e.preventDefault();
                const form = e.target;
                const email = form.email.value.trim();
                const password = form.password.value;

                // Clear previous errors
                this.clearErrors(form);

                // Validation
                if (!this.validateEmail(email)) {
                    this.showFieldError('email-error', 'Geçerli bir e-posta adresi girin');
                    return;
                }

                if (!password) {
                    this.showFieldError('password-error', 'Şifre gereklidir');
                    return;
                }

                // Show loading state
                this.setLoadingState('login', true);

                try {
                    // Simulate API call
                    await this.delay(1500);
                    
                    // Mock successful login
                    this.loginUser({
                        name: 'Kullanıcı Adı',
                        email: email,
                        credits: 3
                    });
                    
                    this.hideLoginModal();
                    this.showSuccessToast('Başarıyla giriş yapıldı!');
                } catch (error) {
                    this.showErrorToast('Giriş yapılırken bir hata oluştu');
                } finally {
                    this.setLoadingState('login', false);
                }
            }

            async handleRegister(e) {
                e.preventDefault();
                const form = e.target;
                const name = form.name.value.trim();
                const email = form.email.value.trim();
                const password = form.password.value;

                // Clear previous errors
                this.clearErrors(form);

                // Validation
                let hasError = false;

                if (!name || name.length < 2) {
                    this.showFieldError('name-error', 'Ad en az 2 karakter olmalıdır');
                    hasError = true;
                }

                if (!this.validateEmail(email)) {
                    this.showFieldError('register-email-error', 'Geçerli bir e-posta adresi girin');
                    hasError = true;
                }

                if (!password || password.length < 8) {
                    this.showFieldError('register-password-error', 'Şifre en az 8 karakter olmalıdır');
                    hasError = true;
                }

                if (hasError) return;

                // Show loading state
                this.setLoadingState('register', true);

                try {
                    // Simulate API call
                    await this.delay(2000);
                    
                    // Mock successful registration
                    this.loginUser({
                        name: name,
                        email: email,
                        credits: 3
                    });
                    
                    this.hideRegisterModal();
                    this.showSuccessToast('Hesabınız başarıyla oluşturuldu!');
                } catch (error) {
                    this.showErrorToast('Kayıt olurken bir hata oluştu');
                } finally {
                    this.setLoadingState('register', false);
                }
            }

            loginUser(userData) {
                AppState.user = userData;
                AppState.credits = userData.credits;
                
                // Update UI
                document.getElementById('login-area').classList.add('hidden');
                document.getElementById('user-area').classList.remove('hidden');
                document.getElementById('user-area').classList.add('flex');
                
                // Update mobile sections
                document.getElementById('mobile-auth-section').classList.add('hidden');
                document.getElementById('mobile-user-section').classList.remove('hidden');
                document.getElementById('mobile-user-options').classList.remove('hidden');
                
                // Update user display
                this.updateUserDisplay(userData);
            }

            logout() {
                AppState.user = null;
                AppState.credits = 3;
                
                // Update UI
                document.getElementById('login-area').classList.remove('hidden');
                document.getElementById('user-area').classList.add('hidden');
                document.getElementById('user-area').classList.remove('flex');
                
                // Update mobile sections
                document.getElementById('mobile-auth-section').classList.remove('hidden');
                document.getElementById('mobile-user-section').classList.add('hidden');
                document.getElementById('mobile-user-options').classList.add('hidden');
                
                this.hideUserDropdown();
                this.showSuccessToast('Başarıyla çıkış yapıldı');
            }

            updateUserDisplay(userData) {
                const initial = userData.name.charAt(0).toUpperCase();
                
                // Desktop
                document.getElementById('user-initial').textContent = initial;
                document.getElementById('username-display').textContent = userData.name;
                document.getElementById('dropdown-username').textContent = userData.name;
                document.getElementById('dropdown-email').textContent = userData.email;
                document.getElementById('credit-count').textContent = userData.credits;
                
                // Mobile
                document.getElementById('mobile-user-initial').textContent = initial;
                document.getElementById('mobile-username').textContent = userData.name;
                document.getElementById('mobile-credit-count').textContent = userData.credits;
            }

            validateEmail(email) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return emailRegex.test(email);
            }

            showFieldError(fieldId, message) {
                const errorElement = document.getElementById(fieldId);
                const inputElement = errorElement.previousElementSibling;
                
                errorElement.textContent = message;
                errorElement.classList.remove('hidden');
                inputElement.classList.add('error-state');
            }

            clearErrors(form) {
                form.querySelectorAll('.text-red-500').forEach(error => {
                    error.classList.add('hidden');
                });
                form.querySelectorAll('.error-state').forEach(input => {
                    input.classList.remove('error-state');
                });
            }

            clearForm(formId) {
                const form = document.getElementById(formId);
                form.reset();
                this.clearErrors(form);
            }

            setLoadingState(type, isLoading) {
                const submitBtn = document.getElementById(`${type}-submit`);
                const textElement = submitBtn.querySelector(`.${type}-text`);
                const loadingElement = submitBtn.querySelector(`.${type}-loading`);
                
                if (isLoading) {
                    submitBtn.disabled = true;
                    submitBtn.classList.add('loading');
                    textElement.classList.add('hidden');
                    loadingElement.classList.remove('hidden');
                } else {
                    submitBtn.disabled = false;
                    submitBtn.classList.remove('loading');
                    textElement.classList.remove('hidden');
                    loadingElement.classList.add('hidden');
                }
            }

            delay(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }

            showErrorToast(message) {
                const toast = document.getElementById('error-toast');
                const messageEl = document.getElementById('error-message');
                messageEl.textContent = message;
                toast.classList.remove('hidden');
                
                setTimeout(() => {
                    toast.classList.add('hidden');
                }, 5000);
            }

            showSuccessToast(message) {
                const toast = document.getElementById('success-toast');
                const messageEl = document.getElementById('success-message');
                messageEl.textContent = message;
                toast.classList.remove('hidden');
                
                setTimeout(() => {
                    toast.classList.add('hidden');
                }, 3000);
            }
        }

        // Loading Manager
        class LoadingManager {
            static show() {
                document.getElementById('loading-overlay').classList.remove('hidden');
                document.getElementById('loading-overlay').classList.add('flex');
                AppState.isLoading = true;
            }

            static hide() {
                document.getElementById('loading-overlay').classList.add('hidden');
                document.getElementById('loading-overlay').classList.remove('flex');
                AppState.isLoading = false;
            }
        }

        // Toast Functions (Global)
        function hideErrorToast() {
            document.getElementById('error-toast').classList.add('hidden');
        }

        function hideSuccessToast() {
            document.getElementById('success-toast').classList.add('hidden');
        }

        // Error Handler
        class ErrorHandler {
            static handle(error, context = '') {
                console.error(`Error in ${context}:`, error);
                
                const authManager = new AuthManager();
                authManager.showErrorToast(`Bir hata oluştu${context ? ` (${context})` : ''}`);
            }
        }

        // Performance Optimization
        class PerformanceOptimizer {
            constructor() {
                this.initLazyLoading();
                this.initPreloading();
            }

            initLazyLoading() {
                // Intersection Observer for lazy loading images
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            img.src = img.dataset.src;
                            img.classList.remove('lazy');
                            observer.unobserve(img);
                        }
                    });
                });

                document.querySelectorAll('img[data-src]').forEach(img => {
                    imageObserver.observe(img);
                });
            }

            initPreloading() {
                // Preload critical resources
                const criticalImages = [
                    'https://i.imgur.com/PZUhNlv.png'
                ];

                criticalImages.forEach(src => {
                    const link = document.createElement('link');
                    link.rel = 'preload';
                    link.as = 'image';
                    link.href = src;
                    document.head.appendChild(link);
                });
            }
        }

        // Progressive Web App Support
        class PWAManager {
            constructor() {
                this.initServiceWorker();
                this.initInstallPrompt();
            }

            async initServiceWorker() {
                if ('serviceWorker' in navigator) {
                    try {
                        const registration = await navigator.serviceWorker.register('/sw.js');
                        console.log('Service Worker registered:', registration);
                    } catch (error) {
                        console.log('Service Worker registration failed:', error);
                    }
                }
            }

            initInstallPrompt() {
                let deferredPrompt;

                window.addEventListener('beforeinstallprompt', (e) => {
                    e.preventDefault();
                    deferredPrompt = e;
                    
                    // Show install button
                    const installBtn = document.createElement('button');
                    installBtn.textContent = 'Uygulamayı Yükle';
                    installBtn.className = 'fixed bottom-4 right-4 bg-dream-primary text-white px-4 py-2 rounded-lg shadow-lg z-50';
                    installBtn.onclick = async () => {
                        deferredPrompt.prompt();
                        const result = await deferredPrompt.userChoice;
                        if (result.outcome === 'accepted') {
                            installBtn.remove();
                        }
                        deferredPrompt = null;
                    };
                    
                    document.body.appendChild(installBtn);
                });
            }
        }

        // Analytics (Mock)
        class Analytics {
            static track(event, data = {}) {
                console.log('Analytics:', event, data);
                // In real app, send to analytics service
            }

            static pageView(page) {
                this.track('page_view', { page });
            }

            static userAction(action, details = {}) {
                this.track('user_action', { action, ...details });
            }
        }

        // Initialize Application
        class App {
            constructor() {
                this.init();
            }

            async init() {
                try {
                    // Show loading
                    LoadingManager.show();

                    // Initialize core managers
                    this.themeManager = new ThemeManager();
                    this.navigationManager = new NavigationManager();
                    this.authManager = new AuthManager();
                    this.performanceOptimizer = new PerformanceOptimizer();
                    this.pwaManager = new PWAManager();

                    // Initialize event listeners
                    this.bindGlobalEvents();

                    // Track initial page view
                    Analytics.pageView('welcome');

                    // Simulate initial load delay
                    await new Promise(resolve => setTimeout(resolve, 1000));

                } catch (error) {
                    ErrorHandler.handle(error, 'App initialization');
                } finally {
                    LoadingManager.hide();
                }
            }

            bindGlobalEvents() {
                // Keyboard navigation
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        // Close any open modals/dropdowns
                        this.authManager.hideLoginModal();
                        this.authManager.hideRegisterModal();
                        this.authManager.hideUserDropdown();
                    }
                });

                // Handle online/offline status
                window.addEventListener('online', () => {
                    this.authManager.showSuccessToast('İnternet bağlantısı yeniden kuruldu');
                });

                window.addEventListener('offline', () => {
                    this.authManager.showErrorToast('İnternet bağlantısı kesildi');
                });

                // Prevent zoom on double tap (mobile)
                let lastTouchEnd = 0;
                document.addEventListener('touchend', (e) => {
                    const now = new Date().getTime();
                    if (now - lastTouchEnd <= 300) {
                        e.preventDefault();
                    }
                    lastTouchEnd = now;
                }, false);
            }
        }

        // Start the application when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            new App();
        });

        // Service Worker for PWA
        const serviceWorkerCode = `
        const CACHE_NAME = 'dreamsync-v1';
        const urlsToCache = [
            '/',
            '/manifest.json',
            'https://cdn.tailwindcss.com',
            'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css',
            'https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap'
        ];

        self.addEventListener('install', (event) => {
            event.waitUntil(
                caches.open(CACHE_NAME)
                    .then((cache) => cache.addAll(urlsToCache))
            );
        });

        self.addEventListener('fetch', (event) => {
            event.respondWith(
                caches.match(event.request)
                    .then((response) => {
                        if (response) {
                            return response;
                        }
                        return fetch(event.request);
                    })
            );
        });
        `;

        // Manifest.json content
        const manifestContent = {
            "name": "DreamSync - Rüya Paylaşım ve Analiz",
            "short_name": "DreamSync",
            "description": "Rüyalarınızı kaydedin, yapay zeka ile analiz edin ve toplulukla paylaşın",
            "start_url": "/",
            "display": "standalone",
            "background_color": "#1e40af",
            "theme_color": "#1e40af",
            "icons": [
                {
                    "src": "/icon-192x192.png",
                    "sizes": "192x192",
                    "type": "image/png"
                },
                {
                    "src": "/icon-512x512.png",
                    "sizes": "512x512",
                    "type": "image/png"
                }
            ]
        };
    </script>
</body>
</html>
